DataWindow.prototype.ShowError=function(c,b,a){this.ScrollToRow(b);this.SetColumn(a);this.ParentWindow.MessageBox("提示",c,ICON.StopSign);this.SetFocus()};DataWindow.prototype.InsertRowEx=function(c,a,b){if(c==null||c=="undefined"){c=0}c=this.InsertRow(c);this.ScrollToRow(c);if(a!=null&&a!=""&&a!="undefined"){this.SetColumn(a)}if(b){this.SetFocus()}return c};DataWindow.prototype.CheckData=function(h,d){if(this.RowCount()<=0){return false}if(!this.AcceptText()){return false}if((this.ModifiedCount()+this.DeletedCount())<=0){this.ParentWindow.MessageBox("提示","没有数据需要保存!");this.SetFocus();return false}var c=false;var a=false;if(h==null||h=="undefined"||h=="*"){c=true;h=new Array()}if(d==null||d=="undefined"||d=="*"){a=true;d=new Array()}if(c||a){var l=parseInt(this.Describe("datawindow.column.count"));var o="";var b="";for(index=1;index<=l;index++){b=this.Describe("#"+index+".Name");o=this.Describe(b+".tag");if(c&&(o=="*"||o=="**")){h[h.length]=b}if(a&&o=="**"){d[d.length]=b}}}var e=0;var f="";var n="";var m=0;var g="";var k="";for(index=0;index<d.length;index++){n=this.Describe(d[index]+"_t.Text");if(n==""||n=="?"||n=="!"){n=b}if(k==""){k=n}else{k+=" + "+n}}for(Row=1;Row<=this.RowCount();Row++){e=this.GetItemStatus(Row,0,DWBUFFER.Primary);if(e==DWITEMSTATUS.NewModified||e==DWITEMSTATUS.DataModified){for(index=0;index<h.length;index++){f=this.Describe(h[index]+".colType");f=f.substring(0,4);n=this.Describe(h[index]+"_t.Text");if(n==""||n=="?"||n=="!"){n=b}if(f=="char"){if(this.GetItemString(Row,h[index])==""){this.ShowError(n+"未输入数据!",Row,h[index]);return false}}else{if(f=="date"||f=="time"){value=new Date(this.GetItemDate(Row,h[index]));if(value!=null&&value.getFullYear()==1900){this.ShowError(n+"未输入数据!",Row,h[index]);return false}}else{if(this.GetItemNumber(Row,h[index])==0){this.ShowError(n+"未输入数据!",Row,h[index]);return false;return false}}}}}if(Row<this.RowCount()&&d.length>0){g="1=1";for(index=0;index<d.length;index++){f=this.Describe(d[index]+".colType");f=f.substring(0,4);if(f=="char"){g+=" AND ("+d[index]+"='"+this.GetItemString(Row,d[index])+"') "}else{if(f=="date"){g+=" AND (Date('"+d[index]+"='"+this.GetItemDate(Row,d[index]).toDateString()+"'))  "}else{if(f=="time"){g+=" AND (Time('"+d[index]+"='"+this.GetItemDate(Row,d[index]).toTimeString()+"')) "}else{g+=" AND ("+d[index]+"="+this.GetItemNumber(Row,d[index])+") "}}}}m=this.Find(g,Row+1,this.RowCount());if(m>0){this.ShowError("第<"+Row+">行与第<"+m+">行的[ "+k+" ]重复,请检查!",Row,d[0]);return false}}}return true};DataWindow.prototype.CopyDataEx=function(e,a,c){if(e<1||e>this.RowCount()){return}if(a==null||a=="undefined"){return}if(c==0){c=a.InsertRow(0);a.ScrollToRow(c)}if(c<1||c>a.RowCount()){return}var d=parseInt(this.Describe("datawindow.column.count"));var b=parseInt(a.Describe("datawindow.column.count"));var f="";var g="";a.SetRedraw(false);for(i=1;i<=d;i++){f=this.Describe("#"+i+".dbName").toLowerCase();for(j=1;j<=b;j++){if(a.Describe("#"+j+".dbName").toLowerCase()!=f){continue}g=this.Describe("#"+i+".colType");g=g.substring(0,4);if(g=="char"){a.SetItem(c,j,this.GetItemString(e,i))}else{if(g=="date"||g=="time"){Value=new Date(this.GetItemDate(e,i));if(Value.getFullYear()!=1900){a.SetItem(c,j,Value.getVarDate())}}else{a.SetItem(c,j,this.GetItemNumber(e,i))}}break}}a.SetRedraw(true)};DataWindow.prototype.TestA=function(){this.PrintPreview()};DataWindow.prototype.TestB=function(){this.ScrollToRow(this.InsertRow(0))};function WebRequestor(){var a=this;this.ServiceUrl="";this.FunctionID="";var c=null;var b=function(){if(c==null){if(window.XMLHttpRequest){c=new window.XMLHttpRequest()}else{c=new ActiveXObject("MSXML2.XMLHTTP.6.0");if(c==null){c=new ActiveXObject("MSXML2.XMLHTTP.4.0")}if(c==null){c=new ActiveXObject("MSXML2.XMLHTTP.3.0")}if(c==null){c=new ActiveXObject("MSXML2.XMLHTTP")}}}};var d=function(){if(a.ServiceUrl==null||a.ServiceUrl==""){return false}if(c==null){b();if(c==null){return false}}c.open("POST",a.ServiceUrl,false);c.setRequestHeader("Content-Type","application/x-www-form-urlencoded; ");return true};this.SetWebServiceUrl=function(e){a.ServiceUrl=e};this.SetFunctionID=function(e){a.FunctionID=e};this.StatusCode=function(){if(c==null){return -1}return c.status};this.ResponseText=function(){if(c==null){return""}return c.responseText};this.Invoke=function(f,e){if(!d()){return}if(arguments.lenght==0||f==null||f==""){return}var g="";if(a.FunctionID!=null&&a.FunctionID.length>0){g="FunID="+a.FunctionID+"&Method="+f}else{g="Method="+f}if(arguments.lenght==1||e==null||e==""){c.send(g)}else{c.send(g+"&"+e)}};this.Release=function(){c=null}};